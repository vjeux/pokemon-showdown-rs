//! Test to compare Rust item coverage against expected JS items
//!
//! NOTE: This test is currently disabled because the Dex system has changed
//! to load items from JSON at runtime instead of having a static ITEMS constant.
//! To properly test item coverage, we would need to:
//! 1. Load all JSON data files in the test
//! 2. Call Dex::load_from_json() with all the data
//!    This is excessive for a simple coverage test.
//!
//! TODO: Re-implement this test to work with the new Dex system

#![allow(dead_code)]

use pokemon_showdown::dex::Dex;
use std::collections::HashSet;

/// List of all items from Pokemon Showdown JS (as of latest sync)
/// Generated by: node dump_items.js
const JS_ITEMS: &[&str] = &[
    "abilityshield",
    "abomasite",
    "absolitez",
    "absorbbulb",
    "adamantcrystal",
    "adamantorb",
    "adrenalineorb",
    "aerodactylite",
    "aggronite",
    "aguavberry",
    "airballoon",
    "alakazite",
    "aloraichiumz",
    "altarianite",
    "ampharosite",
    "apicotberry",
    "armorfossil",
    "aspearberry",
    "assaultvest",
    "audinite",
    "babiriberry",
    "banettite",
    "barbaracite",
    "baxcalibrite",
    "beastball",
    "beedrillite",
    "belueberry",
    "berry",
    "berserkgene",
    "bigroot",
    "bindingband",
    "bitterberry",
    "blackbelt",
    "blackglasses",
    "blacksludge",
    "blastoisinite",
    "blazikenite",
    "blueorb",
    "blukberry",
    "blunderpolicy",
    "boosterenergy",
    "brightpowder",
    "buggem",
    "bugmemory",
    "buginiumz",
    "burntberry",
    "cameruptite",
    "cellbattery",
    "chandelurite",
    "charcoal",
    "charizarditex",
    "charizarditey",
    "chartiberry",
    "cheriberry",
    "cherishball",
    "chesnaught",
    "chesnaughtite",
    "chestoberry",
    "chilanberry",
    "chimechite",
    "choiceband",
    "choicescarf",
    "choicespecs",
    "chopleberry",
    "clawfossil",
    "clefablite",
    "clearamulet",
    "cobaberry",
    "colburberry",
    "cornerstonemask",
    "cornnberry",
    "coverfossil",
    "covertcloak",
    "crabominite",
    "crucibellite",
    "custapberry",
    "damprock",
    "darkgem",
    "darkiniumz",
    "darkmemory",
    "darkranite",
    "dawnstone",
    "deepseascale",
    "deepseatooth",
    "delphoxite",
    "destinyknot",
    "diaborite",
    "diancite",
    "diveball",
    "domefossil",
    "dousedrive",
    "dracoplate",
    "dragalgite",
    "dragongem",
    "dragoninite",
    "dragonmemory",
    "dragoniumz",
    "dragonscale",
    "drampanite",
    "dreadplate",
    "dreamball",
    "dubiousdisc",
    "durinberry",
    "duskball",
    "duskstone",
    "earthplate",
    "eelektrossite",
    "ejectbutton",
    "ejectpack",
    "electirizer",
    "electricgem",
    "electricmemory",
    "electricseed",
    "electriumz",
    "emboarite",
    "enigmaberry",
    "eviolite",
    "excadrite",
    "expertbelt",
    "fairiumz",
    "fairygem",
    "fairymemory",
    "falinksite",
    "fastball",
    "fightinggem",
    "fightingmemory",
    "fightiniumz",
    "figyberry",
    "firegem",
    "firememory",
    "firestone",
    "firiumz",
    "fistplate",
    "flameorb",
    "flameplate",
    "floatstone",
    "floettite",
    "flyinggem",
    "flyingmemory",
    "flyiniumz",
    "focusband",
    "focussash",
    "fossilizedbird",
    "fossilizeddinof",
    "fossilizeddrake",
    "fossilizedfish",
    "friendball",
    "froslassite",
    "fullincense",
    "galaborite",
    "gaborite",
    "galladite",
    "ganlonberry",
    "garchompite",
    "garchompitez",
    "gardevoirite",
    "gengarite",
    "ghostgem",
    "ghostmemory",
    "ghostiumz",
    "glalitite",
    "glimmoranite",
    "goldberry",
    "golisopite",
    "golurkite",
    "grassgem",
    "grassmemory",
    "grassiumz",
    "grassyseed",
    "greatball",
    "grepaberry",
    "greninjite",
    "gripclaw",
    "griseouscore",
    "griseousorb",
    "groundgem",
    "groundmemory",
    "groundiumz",
    "gyaradosite",
    "habanberry",
    "hardstone",
    "healball",
    "hearthflamemask",
    "heatranite",
    "heavyball",
    "heavydutyboots",
    "helixfossil",
    "heracronite",
    "hondewberry",
    "houndoominite",
    "iapapaberry",
    "iceberry",
    "icegem",
    "icememory",
    "icestone",
    "icicleplate",
    "iciumz",
    "insectplate",
    "ironball",
    "ironplate",
    "jabocaberry",
    "jawfossil",
    "kalosite",
    "kangaskhanite",
    "kasibberry",
    "kebiaberry",
    "keeberry",
    "kelpsyberry",
    "kingsrock",
    "kommoniumz",
    "laggingtail",
    "lansatberry",
    "laxincense",
    "leafstone",
    "leek",
    "leftovers",
    "leppaberry",
    "levelball",
    "liechiberry",
    "lifeorb",
    "lightball",
    "lightclay",
    "loadeddice",
    "lopunnite",
    "loveballf",
    "lucarionitez",
    "lucarionite",
    "luckypunch",
    "lumberry",
    "luminousmoss",
    "lunaliumz",
    "lureball",
    "lustrousglobe",
    "lustrousorb",
    "luxuryball",
    "lycaniumz",
    "machobrace",
    "magearnite",
    "magicalmoss",
    "magmarizer",
    "magnet",
    "mail",
    "malamarite",
    "marangaberry",
    "marshadiumz",
    "masterball",
    "mawilite",
    "meadowplate",
    "medichamite",
    "meganiumite",
    "mentalherb",
    "meowsticite",
    "metagrossite",
    "metalalloy",
    "metalcoat",
    "metalpowder",
    "metronome",
    "mewniumz",
    "mewtwonitex",
    "mewtwonitey",
    "micleberry",
    "mimikiumz",
    "mindplate",
    "mintberry",
    "miracleberry",
    "miracleseed",
    "mirrorherb",
    "mistyseed",
    "moonball",
    "moonstone",
    "muscleband",
    "mysterberry",
    "mysteryberry",
    "mysticwater",
    "naggingtail",
    "nanabberry",
    "nestball",
    "netball",
    "normaliumz",
    "normalgem",
    "occaberry",
    "oddincense",
    "oldboulder",
    "oldamber",
    "ovalstone",
    "oranberry",
    "paldiniumz",
    "pamtreberry",
    "parkball",
    "passhoberry",
    "payapaberry",
    "pechaberry",
    "persimberry",
    "petayaberry",
    "pidgeotite",
    "pikaniumz",
    "pikashuniumz",
    "pinapberry",
    "pinkbow",
    "pinsirite",
    "pixieplate",
    "plumefossil",
    "poisonbarb",
    "poisongem",
    "poisonmemory",
    "poisoniumz",
    "pokeball",
    "polkadotbow",
    "pomegberry",
    "poweranklet",
    "powerband",
    "powerbelt",
    "powerbracer",
    "powerherb",
    "powerlens",
    "powerweight",
    "premierball",
    "primariumz",
    "prismscale",
    "protectivepads",
    "protector",
    "przcureberry",
    "psncureberry",
    "psychicgem",
    "psychicmemory",
    "psychicseed",
    "psychiumz",
    "pungentroot",
    "pyroarite",
    "qualotberry",
    "quickball",
    "quickclaw",
    "quickpowder",
    "rabutaberry",
    "raichunitex",
    "raichunitey",
    "rarebone",
    "rawstberry",
    "razorclaw",
    "razorfang",
    "reapercloth",
    "redcard",
    "redorb",
    "repeatball",
    "rindoberry",
    "ringtarget",
    "rockgem",
    "rockincense",
    "rockmemory",
    "rockiumz",
    "rockyhelmet",
    "roomservice",
    "rootfossil",
    "roseincense",
    "roseliberry",
    "rowapberry",
    "rustedshield",
    "rustedsword",
    "sablenite",
    "sachet",
    "safariball",
    "safetygoggles",
    "sailfossil",
    "salacberry",
    "salamencite",
    "sceptilite",
    "scolipite",
    "scovillainite",
    "scraftinite",
    "scizorite",
    "scopelens",
    "seaincense",
    "sharpbeak",
    "sharpedonite",
    "shedshell",
    "shellbell",
    "shinystone",
    "shockdrive",
    "shucaberry",
    "silkscarf",
    "silverpowder",
    "sitrusberry",
    "skarmorite",
    "skullfossil",
    "skyplate",
    "slowbronite",
    "smoothrock",
    "snorliumz",
    "snowball",
    "softsand",
    "solganiumz",
    "souldew",
    "spelltag",
    "spelonberry",
    "splashplate",
    "spookyplate",
    "sportball",
    "staraptite",
    "starfberry",
    "starminite",
    "steelgem",
    "steelmemory",
    "steeliumz",
    "steelixite",
    "stick",
    "stickybarb",
    "stoneplate",
    "stormdrain",
    "strawberrysweet",
    "sunstone",
    "swampertite",
    "sweetapple",
    "syrupyapple",
    "tamatoberry",
    "tangaberry",
    "tapuniumz",
    "tartapple",
    "tatsugirinite",
    "terrainextender",
    "thickclub",
    "throatspray",
    "thunderstone",
    "timerball",
    "toxicorb",
    "toxicplate",
    "tr00",
    "tr01",
    "tr02",
    "tr03",
    "tr04",
    "tr05",
    "tr06",
    "tr07",
    "tr08",
    "tr09",
    "tr10",
    "tr11",
    "tr12",
    "tr13",
    "tr14",
    "tr15",
    "tr16",
    "tr17",
    "tr18",
    "tr19",
    "tr20",
    "tr21",
    "tr22",
    "tr23",
    "tr24",
    "tr25",
    "tr26",
    "tr27",
    "tr28",
    "tr29",
    "tr30",
    "tr31",
    "tr32",
    "tr33",
    "tr34",
    "tr35",
    "tr36",
    "tr37",
    "tr38",
    "tr39",
    "tr40",
    "tr41",
    "tr42",
    "tr43",
    "tr44",
    "tr45",
    "tr46",
    "tr47",
    "tr48",
    "tr49",
    "tr50",
    "tr51",
    "tr52",
    "tr53",
    "tr54",
    "tr55",
    "tr56",
    "tr57",
    "tr58",
    "tr59",
    "tr60",
    "tr61",
    "tr62",
    "tr63",
    "tr64",
    "tr65",
    "tr66",
    "tr67",
    "tr68",
    "tr69",
    "tr70",
    "tr71",
    "tr72",
    "tr73",
    "tr74",
    "tr75",
    "tr76",
    "tr77",
    "tr78",
    "tr79",
    "tr80",
    "tr81",
    "tr82",
    "tr83",
    "tr84",
    "tr85",
    "tr86",
    "tr87",
    "tr88",
    "tr89",
    "tr90",
    "tr91",
    "tr92",
    "tr93",
    "tr94",
    "tr95",
    "tr96",
    "tr97",
    "tr98",
    "tr99",
    "twistedspoon",
    "tyranitarite",
    "ultraball",
    "ultranecroziumz",
    "unremarkableteacup",
    "upgrade",
    "utilityumbrella",
    "venusaurite",
    "victreebelite",
    "vilevial",
    "wacanberry",
    "watergem",
    "wateriumz",
    "watermemory",
    "waterstone",
    "watmelberry",
    "waveincense",
    "weaknesspolicy",
    "wellspringmask",
    "wepearberry",
    "whippeddream",
    "whiteherb",
    "widelens",
    "wikiberry",
    "wiseglasses",
    "yacheberry",
    "zapplate",
    "zeraorite",
    "zoomlens",
    "zygardite",
];

#[test]
#[ignore = "Needs update for new Dex system"]
fn test_item_coverage() {
    // Load items from Dex
    let dex = Dex::new(9);
    let rust_items: HashSet<String> = dex
        .items
        .keys()
        .map(|id: &pokemon_showdown::dex_data::ID| id.to_string())
        .collect();

    let js_items: HashSet<&str> = JS_ITEMS.iter().copied().collect();

    // Find missing items
    let missing: Vec<&&str> = JS_ITEMS
        .iter()
        .filter(|item| !rust_items.contains(**item))
        .collect();

    // Find extra items
    let extra: Vec<&String> = rust_items
        .iter()
        .filter(|item: &&String| !js_items.contains(item.as_str()))
        .collect();

    println!("\n=== Item Coverage Report ===");
    println!("JS items: {}", JS_ITEMS.len());
    println!("Rust items: {}", rust_items.len());
    println!("Missing from Rust: {}", missing.len());
    println!("Extra in Rust: {}", extra.len());

    if !missing.is_empty() {
        println!("\nMissing items:");
        for item in &missing {
            println!("  - {}", item);
        }
    }

    if !extra.is_empty() {
        println!("\nExtra items:");
        for item in &extra {
            println!("  - {}", item);
        }
    }

    let coverage = (rust_items.len() - extra.len()) as f64 / JS_ITEMS.len() as f64 * 100.0;
    println!("\nCoverage: {:.1}%", coverage);

    // This test passes as long as we have at least 85% coverage
    assert!(coverage >= 85.0, "Item coverage should be at least 85%");
}
