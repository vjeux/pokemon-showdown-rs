# Battle Module TODO


## battle.rs

**Total methods:** 186 (125 public, 61 private)

### Public Methods

- [x] `new` (line 165)
- [x] `new` (line 388)
- [x] `pokemon_at` (line 493)
- [x] `pokemon_at_mut` (line 500)
- [x] `set_player` (line 544)
- [x] `start` (line 711)
- [x] `start_battle` (line 840)
- [x] `switch_in` (line 877)
- [x] `add_log` (line 1050)
- [x] `random` (line 1065)
- [x] `random_chance` (line 1076)
- [x] `sample` (line 1089)
- [x] `shuffle` (line 1094)
- [x] `get_side` (line 1104)
- [x] `get_side_mut` (line 1109)
- [x] `p1` (line 1114)
- [x] `p2` (line 1119)
- [x] `get_all_active` (line 1139)
- [x] `check_win` (line 1172)
- [x] `end` (line 1233)
- [x] `next_effect_order` (line 1246)
- [x] `init_effect_state` (line 1265)
- [x] `choose` (line 1295)
- [x] `get_log` (line 1609)
- [x] `make_choices` (line 1632)
- [x] `drag_in` (line 2011)
- [x] `run_switch` (line 2085)
- [x] `cure_status` (line 2436)
- [x] `debug` (line 2862)
- [x] `get_debug_log` (line 2875)
- [x] `add` (line 2907)
- [x] `add_move` (line 2982)
- [x] `hint` (line 3004)
- [x] `trunc` (line 3031)
- [x] `chain` (line 3055)
- [x] `chain_f` (line 3067)
- [x] `modify` (line 3094)
- [x] `modify_tuple` (line 3104)
- [x] `modify_f` (line 3110)
- [x] `event_modifier` (line 3120)
- [x] `tie` (line 3131)
- [x] `win` (line 3164)
- [x] `lose` (line 3246)
- [x] `force_win` (line 3313)
- [x] `set_active_move` (line 3331)
- [x] `clear_active_move` (line 3351)
- [x] `suppressing_ability` (line 3371)
- [x] `get_all_pokemon` (line 3425)
- [x] `get_random_target` (line 3473)
- [x] `update_speed` (line 3571)
- [x] `damage` (line 3607)
- [x] `direct_damage` (line 3702)
- [x] `heal` (line 3926)
- [x] `boost` (line 4158)
- [x] `faint` (line 4301)
- [x] `check_fainted` (line 4340)
- [x] `clamp_int_range` (line 4353)
- [x] `compare_priority` (line 4385)
- [x] `compare_redirect_order` (line 4424)
- [x] `compare_left_to_right_order` (line 4450)
- [x] `speed_sort` (line 4504)
- [x] `get_pokemon` (line 4569)
- [x] `get_pokemon_mut` (line 4582)
- [x] `can_switch` (line 4601)
- [x] `get_random_switchable` (line 4613)
- [x] `get_loc_of` (line 4667)
- [x] `valid_target_loc` (line 4728)
- [x] `valid_target` (line 4810)
- [x] `get_at_slot` (line 4822)
- [x] `end_turn` (line 5036)
- [x] `turn_loop` (line 5153)
- [x] `run_action` (line 5489)
- [x] `all_choices_done` (line 5605)
- [x] `check_move_makes_contact` (line 5645)
- [x] `get_action_speed` (line 5711)
- [x] `swap_position` (line 5816)
- [x] `get_category` (line 5913)
- [x] `clear_request` (line 5931)
- [x] `make_request` (line 5979)
- [x] `maybe_trigger_endless_battle_clause` (line 6128)
- [x] `restart` (line 6177)
- [x] `reset_rng` (line 6197)
- [x] `join` (line 6218)
- [x] `destroy` (line 6283)
- [x] `single_event` (line 6387)
- [x] `run_event` (line 7329)
- [x] `run_event_bool` (line 7404)
- [x] `priority_event` (line 7604)
- [x] `get_event_modifier` (line 7616)
- [x] `set_event_modifier` (line 7621)
- [x] `randomizer` (line 7643)
- [x] `each_event` (line 7671)
- [x] `get_target` (line 7757)
- [x] `undo_choice` (line 7904)
- [x] `spread_damage` (line 8041)
- [x] `final_modify` (line 8302)
- [x] `add_split` (line 8340)
- [x] `attr_last_move` (line 8382)
- [x] `chain_modify` (line 8432)
- [x] `check_ev_balance` (line 8468)
- [x] `clear_effect_state` (line 8514)
- [x] `debug_error` (line 8530)
- [x] `field_event` (line 8629)
- [x] `get_callback` (line 8669)
- [x] `get_overflowed_turn_count` (line 8688)
- [x] `get_requests` (line 8749)
- [x] `get_team` (line 8788)
- [x] `resolve_priority` (line 8868)
- [x] `retarget_last_move` (line 8961)
- [x] `run_pick_team` (line 9027)
- [x] `send_updates` (line 9092)
- [x] `show_open_team_sheets` (line 9143)
- [x] `spread_modify` (line 9161)
- [x] `stat_modify` (line 9196)
- [x] `tiebreak` (line 9302)
- [x] `to_json` (line 9441)
- [x] `to_string` (line 9453)
- [x] `find_battle_event_handlers` (line 9488)
- [x] `find_field_event_handlers` (line 9532)
- [x] `find_side_event_handlers` (line 9574)
- [x] `find_pokemon_event_handlers` (line 9652)
- [x] `get_damage` (line 9714)
- [x] `try_spread_move_hit` (line 9897)
- [x] `on_event` (line 10230)
- [x] `on_event_priority` (line 10244)

### Private Methods

- [x] `fmt` (line 99)
- [x] `from` (line 110)
- [x] `from` (line 116)
- [x] `from` (line 122)
- [x] `fmt` (line 128)
- [x] `default` (line 177)
- [x] `from_event_info` (line 211)
- [x] `minimal` (line 223)
- [x] `each_event_internal` (line 1038)
- [x] `get_foe_pokemon_left` (line 1199)
- [x] `validate_single_choice` (line 1322)
- [x] `parse_choice` (line 1650)
- [x] `commit_choices` (line 1815)
- [x] `find_valid_switch_target` (line 1946)
- [x] `do_switch` (line 1957)
- [x] `do_switch_with_drag` (line 2043)
- [x] `field_event_switch_in` (line 2118)
- [x] `trigger_switch_in_abilities` (line 2127)
- [x] `apply_hazards` (line 2137)
- [x] `run_move` (line 2206)
- [x] `get_move_target` (line 2249)
- [x] `get_move_priority` (line 2273)
- [x] `get_multi_hit_count` (line 2283)
- [x] `get_move_accuracy` (line 2315)
- [x] `apply_confusion` (line 2328)
- [x] `remove_all_hazards` (line 2354)
- [x] `apply_status` (line 2378)
- [x] `apply_boost` (line 2489)
- [x] `run_residual` (line 2531)
- [x] `faint_messages` (line 2637)
- [x] `next_turn` (line 2798)
- [x] `add_direct_damage_log` (line 3845)
- [x] `add_heal_log` (line 4024)
- [x] `boost_stats` (line 4284)
- [x] `shuffle_range` (line 4545)
- [x] `possible_switches` (line 4637)
- [x] `get_pokemon_action_speed` (line 5775)
- [x] `get_effect_type` (line 6510)
- [x] `dispatch_single_event` (line 6545)
- [x] `handle_ability_event` (line 6580)
- [x] `handle_item_event` (line 6732)
- [x] `handle_move_event` (line 6835)
- [x] `check_volatile_try_hit` (line 6914)
- [x] `handle_condition_event` (line 6951)
- [x] `handle_side_condition_event` (line 7017)
- [x] `find_event_handlers` (line 7491)
- [x] `get_at_loc` (line 7846)
- [x] `add_damage_log` (line 8245)
- [x] `modify_internal` (line 8315)
- [x] `modify_damage` (line 9841)
- [x] `spread_move_hit` (line 9930)
- [x] `get_spread_damage` (line 9995)
- [x] `run_move_effects` (line 10021)
- [x] `game_type_to_string` (line 10147)
- [x] `run_custom_event_handlers` (line 10271)
- [x] `create_test_team` (line 10326)
- [x] `fmt` (line 10439)

---

## battle_actions.rs

**Total methods:** 76 (63 public, 13 private)

### Public Methods

- [x] `get_max_move_name` (line 29)
- [x] `get_z_move_name` (line 55)
- [x] `new` (line 268)
- [x] `calculate_damage` (line 275)
- [x] `get_boost_modifier` (line 363)
- [x] `calculate_stat_with_boost` (line 384)
- [x] `calc_recoil_damage` (line 399)
- [x] `get_confusion_damage` (line 433)
- [x] `target_type_choices` (line 450)
- [x] `combine_results` (line 475)
- [x] `get_z_move` (line 518)
- [x] `can_z_move` (line 591)
- [x] `get_max_move` (line 636)
- [x] `can_mega_evo` (line 690)
- [x] `can_ultra_burst` (line 734)
- [x] `can_terastallize` (line 753)
- [x] `hit_step_invulnerability_event` (line 795)
- [x] `hit_step_type_immunity` (line 824)
- [x] `hit_step_accuracy` (line 906)
- [x] `hit_step_break_protect` (line 988)
- [x] `hit_step_steal_boosts` (line 1038)
- [x] `self_drops` (line 1081)
- [x] `get_secondaries` (line 1093)
- [x] `get_active_z_move` (line 1132)
- [x] `get_active_max_move` (line 1204)
- [x] `get_z_power_effect` (line 1258)
- [x] `get_spread_damage_modifier` (line 1272)
- [x] `modify_damage` (line 1399)
- [x] `should_force_switch` (line 1412)
- [x] `get_multi_hit_count` (line 1431)
- [x] `is_critical_hit` (line 1452)
- [x] `run_mega_evo_check` (line 1486)
- [x] `terastallize_check` (line 1500)
- [x] `get_damage` (line 1663)
- [x] `try_spread_move_hit_check` (line 1708)
- [x] `move_hit_result` (line 1723)
- [x] `hit_step_try_immunity` (line 1763)
- [x] `hit_step_try_hit_event` (line 1804)
- [x] `after_move_secondary_event` (line 1827)
- [x] `try_move_hit_check` (line 1839)
- [x] `hit_step_move_hit_loop_count` (line 1849)
- [x] `spread_move_hit_modifier` (line 1867)
- [x] `try_primary_hit_event` (line 1884)
- [x] `run_move_effects_list` (line 1902)
- [x] `run_move_stub` (line 2011)
- [x] `use_move_stub` (line 2034)
- [x] `use_move_inner_stub` (line 2049)
- [x] `try_spread_move_hit_stub` (line 2063)
- [x] `hit_step_move_hit_loop_stub` (line 2077)
- [x] `spread_move_hit_stub` (line 2103)
- [x] `move_hit_stub` (line 2128)
- [x] `get_spread_damage_stub` (line 2161)
- [x] `force_switch_stub` (line 2178)
- [x] `run_z_power` (line 2235)
- [x] `run_mega_evo_stub` (line 2277)
- [x] `terastallize_stub` (line 2298)
- [x] `try_move_hit_stub` (line 2326)
- [x] `secondaries_stub` (line 2357)
- [x] `switch_in_stub` (line 2386)
- [x] `drag_in_stub` (line 2406)
- [x] `run_switch_stub` (line 2421)
- [x] `use_move` (line 2509)
- [x] `use_move_inner` (line 2707)

### Private Methods

- [x] `get_accuracy_modifier` (line 939)
- [x] `z_move_power_table` (line 1164)
- [x] `max_move_power_table` (line 1241)
- [x] `default` (line 1985)
- [x] `test_boost_modifier` (line 3028)
- [x] `test_stat_with_boost` (line 3038)
- [x] `test_recoil_damage` (line 3048)
- [x] `test_confusion_damage` (line 3060)
- [x] `test_target_type_choices` (line 3067)
- [x] `test_max_move_name` (line 3076)
- [x] `test_z_move_name` (line 3084)
- [x] `test_can_ultra_burst` (line 3091)
- [x] `test_can_terastallize` (line 3107)

---

## battle_queue.rs

**Total methods:** 45 (43 public, 2 private)

### Public Methods

- [x] `order` (line 158)
- [x] `priority` (line 188)
- [x] `speed` (line 199)
- [x] `fractional_priority` (line 210)
- [x] `pokemon_index` (line 218)
- [x] `side_index` (line 229)
- [x] `is_move` (line 240)
- [x] `is_switch` (line 245)
- [x] `is_run_switch` (line 250)
- [x] `get_switch_target` (line 255)
- [x] `new` (line 272)
- [x] `shift` (line 284)
- [x] `peek` (line 297)
- [x] `peek_end` (line 302)
- [x] `push` (line 311)
- [x] `unshift` (line 320)
- [x] `len` (line 325)
- [x] `is_empty` (line 330)
- [x] `clear` (line 340)
- [x] `cancel_action` (line 357)
- [x] `cancel_move` (line 377)
- [x] `will_move` (line 403)
- [x] `will_move_pokemon` (line 416)
- [x] `will_switch` (line 431)
- [x] `will_act` (line 453)
- [x] `insert_run_switch` (line 461)
- [x] `insert_choice` (line 517)
- [x] `sort` (line 530)
- [x] `prioritize_action` (line 573)
- [x] `iter` (line 588)
- [x] `iter_mut` (line 593)
- [x] `will_act_full` (line 602)
- [x] `change_action` (line 628)
- [x] `insert_in_order` (line 635)
- [x] `add_choice` (line 690)
- [x] `debug` (line 705)
- [x] `entries` (line 737)
- [x] `entries_mut` (line 742)
- [x] `find` (line 747)
- [x] `remove_where` (line 755)
- [x] `prioritize_action_ref` (line 772)
- [x] `resolve_action` (line 912)
- [x] `get_order_for_choice` (line 1008)
