# Battle Module TODO


## battle.rs

**Total methods:** 186 (125 public, 61 private)

### Public Methods

- [x] `new` (line 165)
- [ ] `new` (line 388)
- [x] `pokemon_at` (line 493)
- [x] `pokemon_at_mut` (line 500)
- [x] `set_player` (line 544)
- [x] `start` (line 711)
- [ ] `start_battle` (line 840)
- [ ] `switch_in` (line 877)
- [x] `add_log` (line 1050)
- [x] `random` (line 1065)
- [x] `random_chance` (line 1076)
- [x] `sample` (line 1089)
- [x] `shuffle` (line 1094)
- [x] `get_side` (line 1104)
- [x] `get_side_mut` (line 1109)
- [x] `p1` (line 1114)
- [x] `p2` (line 1119)
- [x] `get_all_active` (line 1139)
- [x] `check_win` (line 1172)
- [x] `end` (line 1233)
- [x] `next_effect_order` (line 1246)
- [x] `init_effect_state` (line 1265)
- [x] `choose` (line 1295)
- [x] `get_log` (line 1609)
- [x] `make_choices` (line 1632)
- [x] `drag_in` (line 2011)
- [x] `run_switch` (line 2085)
- [x] `cure_status` (line 2436)
- [x] `debug` (line 2862)
- [x] `get_debug_log` (line 2875)
- [x] `add` (line 2907)
- [x] `add_move` (line 2982)
- [x] `hint` (line 3004)
- [x] `trunc` (line 3031)
- [x] `chain` (line 3055)
- [x] `chain_f` (line 3067)
- [x] `modify` (line 3094)
- [x] `modify_tuple` (line 3104)
- [x] `modify_f` (line 3110)
- [x] `event_modifier` (line 3120)
- [ ] `tie` (line 3131)
- [ ] `win` (line 3164)
- [ ] `lose` (line 3246)
- [ ] `force_win` (line 3313)
- [ ] `set_active_move` (line 3331)
- [ ] `clear_active_move` (line 3351)
- [ ] `suppressing_ability` (line 3371)
- [ ] `get_all_pokemon` (line 3425)
- [ ] `get_random_target` (line 3473)
- [ ] `update_speed` (line 3571)
- [ ] `damage` (line 3607)
- [ ] `direct_damage` (line 3702)
- [ ] `heal` (line 3926)
- [ ] `boost` (line 4158)
- [ ] `faint` (line 4301)
- [ ] `check_fainted` (line 4340)
- [ ] `clamp_int_range` (line 4353)
- [ ] `compare_priority` (line 4385)
- [ ] `compare_redirect_order` (line 4424)
- [ ] `compare_left_to_right_order` (line 4450)
- [ ] `speed_sort` (line 4504)
- [ ] `get_pokemon` (line 4569)
- [ ] `get_pokemon_mut` (line 4582)
- [ ] `can_switch` (line 4601)
- [ ] `get_random_switchable` (line 4613)
- [ ] `get_loc_of` (line 4667)
- [ ] `valid_target_loc` (line 4728)
- [ ] `valid_target` (line 4810)
- [ ] `get_at_slot` (line 4822)
- [ ] `end_turn` (line 5036)
- [ ] `turn_loop` (line 5153)
- [ ] `run_action` (line 5489)
- [ ] `all_choices_done` (line 5605)
- [ ] `check_move_makes_contact` (line 5645)
- [ ] `get_action_speed` (line 5711)
- [ ] `swap_position` (line 5816)
- [ ] `get_category` (line 5913)
- [ ] `clear_request` (line 5931)
- [ ] `make_request` (line 5979)
- [ ] `maybe_trigger_endless_battle_clause` (line 6128)
- [ ] `restart` (line 6177)
- [ ] `reset_rng` (line 6197)
- [ ] `join` (line 6218)
- [ ] `destroy` (line 6283)
- [ ] `single_event` (line 6387)
- [ ] `run_event` (line 7329)
- [ ] `run_event_bool` (line 7404)
- [ ] `priority_event` (line 7604)
- [ ] `get_event_modifier` (line 7616)
- [ ] `set_event_modifier` (line 7621)
- [ ] `randomizer` (line 7643)
- [ ] `each_event` (line 7671)
- [ ] `get_target` (line 7757)
- [ ] `undo_choice` (line 7904)
- [ ] `spread_damage` (line 8041)
- [ ] `final_modify` (line 8302)
- [ ] `add_split` (line 8340)
- [ ] `attr_last_move` (line 8382)
- [ ] `chain_modify` (line 8432)
- [ ] `check_ev_balance` (line 8468)
- [ ] `clear_effect_state` (line 8514)
- [ ] `debug_error` (line 8530)
- [ ] `field_event` (line 8629)
- [ ] `get_callback` (line 8669)
- [ ] `get_overflowed_turn_count` (line 8688)
- [ ] `get_requests` (line 8749)
- [ ] `get_team` (line 8788)
- [ ] `resolve_priority` (line 8868)
- [ ] `retarget_last_move` (line 8961)
- [ ] `run_pick_team` (line 9027)
- [ ] `send_updates` (line 9092)
- [ ] `show_open_team_sheets` (line 9143)
- [ ] `spread_modify` (line 9161)
- [ ] `stat_modify` (line 9196)
- [ ] `tiebreak` (line 9302)
- [ ] `to_json` (line 9441)
- [ ] `to_string` (line 9453)
- [ ] `find_battle_event_handlers` (line 9488)
- [ ] `find_field_event_handlers` (line 9532)
- [ ] `find_side_event_handlers` (line 9574)
- [ ] `find_pokemon_event_handlers` (line 9652)
- [ ] `get_damage` (line 9714)
- [ ] `try_spread_move_hit` (line 9897)
- [ ] `on_event` (line 10230)
- [ ] `on_event_priority` (line 10244)

### Private Methods

- [ ] `fmt` (line 99)
- [ ] `from` (line 110)
- [ ] `from` (line 116)
- [ ] `from` (line 122)
- [ ] `fmt` (line 128)
- [ ] `default` (line 177)
- [ ] `from_event_info` (line 211)
- [ ] `minimal` (line 223)
- [ ] `each_event_internal` (line 1038)
- [ ] `get_foe_pokemon_left` (line 1199)
- [ ] `validate_single_choice` (line 1322)
- [ ] `parse_choice` (line 1650)
- [ ] `commit_choices` (line 1815)
- [ ] `find_valid_switch_target` (line 1946)
- [ ] `do_switch` (line 1957)
- [ ] `do_switch_with_drag` (line 2043)
- [ ] `field_event_switch_in` (line 2118)
- [ ] `trigger_switch_in_abilities` (line 2127)
- [ ] `apply_hazards` (line 2137)
- [ ] `run_move` (line 2206)
- [ ] `get_move_target` (line 2249)
- [ ] `get_move_priority` (line 2273)
- [ ] `get_multi_hit_count` (line 2283)
- [ ] `get_move_accuracy` (line 2315)
- [ ] `apply_confusion` (line 2328)
- [ ] `remove_all_hazards` (line 2354)
- [ ] `apply_status` (line 2378)
- [ ] `apply_boost` (line 2489)
- [ ] `run_residual` (line 2531)
- [ ] `faint_messages` (line 2637)
- [ ] `next_turn` (line 2798)
- [ ] `add_direct_damage_log` (line 3845)
- [ ] `add_heal_log` (line 4024)
- [ ] `boost_stats` (line 4284)
- [ ] `shuffle_range` (line 4545)
- [ ] `possible_switches` (line 4637)
- [ ] `get_pokemon_action_speed` (line 5775)
- [ ] `get_effect_type` (line 6510)
- [ ] `dispatch_single_event` (line 6545)
- [ ] `handle_ability_event` (line 6580)
- [ ] `handle_item_event` (line 6732)
- [ ] `handle_move_event` (line 6835)
- [ ] `check_volatile_try_hit` (line 6914)
- [ ] `handle_condition_event` (line 6951)
- [ ] `handle_side_condition_event` (line 7017)
- [ ] `find_event_handlers` (line 7491)
- [ ] `get_at_loc` (line 7846)
- [ ] `add_damage_log` (line 8245)
- [ ] `modify_internal` (line 8315)
- [ ] `modify_damage` (line 9841)
- [ ] `spread_move_hit` (line 9930)
- [ ] `get_spread_damage` (line 9995)
- [ ] `run_move_effects` (line 10021)
- [ ] `game_type_to_string` (line 10147)
- [ ] `run_custom_event_handlers` (line 10271)
- [ ] `create_test_team` (line 10326)
- [ ] `fmt` (line 10439)

---

## battle_actions.rs

**Total methods:** 76 (63 public, 13 private)

### Public Methods

- [ ] `get_max_move_name` (line 29)
- [ ] `get_z_move_name` (line 55)
- [ ] `new` (line 268)
- [ ] `calculate_damage` (line 275)
- [ ] `get_boost_modifier` (line 363)
- [ ] `calculate_stat_with_boost` (line 384)
- [ ] `calc_recoil_damage` (line 399)
- [ ] `get_confusion_damage` (line 433)
- [ ] `target_type_choices` (line 450)
- [ ] `combine_results` (line 475)
- [ ] `get_z_move` (line 518)
- [ ] `can_z_move` (line 591)
- [ ] `get_max_move` (line 636)
- [ ] `can_mega_evo` (line 690)
- [ ] `can_ultra_burst` (line 734)
- [ ] `can_terastallize` (line 753)
- [ ] `hit_step_invulnerability_event` (line 795)
- [ ] `hit_step_type_immunity` (line 824)
- [ ] `hit_step_accuracy` (line 906)
- [ ] `hit_step_break_protect` (line 988)
- [ ] `hit_step_steal_boosts` (line 1038)
- [ ] `self_drops` (line 1081)
- [ ] `get_secondaries` (line 1093)
- [ ] `get_active_z_move` (line 1132)
- [ ] `get_active_max_move` (line 1204)
- [ ] `get_z_power_effect` (line 1258)
- [ ] `get_spread_damage_modifier` (line 1272)
- [ ] `modify_damage` (line 1399)
- [ ] `should_force_switch` (line 1412)
- [ ] `get_multi_hit_count` (line 1431)
- [ ] `is_critical_hit` (line 1452)
- [ ] `run_mega_evo_check` (line 1486)
- [ ] `terastallize_check` (line 1500)
- [ ] `get_damage` (line 1663)
- [ ] `try_spread_move_hit_check` (line 1708)
- [ ] `move_hit_result` (line 1723)
- [ ] `hit_step_try_immunity` (line 1763)
- [ ] `hit_step_try_hit_event` (line 1804)
- [ ] `after_move_secondary_event` (line 1827)
- [ ] `try_move_hit_check` (line 1839)
- [ ] `hit_step_move_hit_loop_count` (line 1849)
- [ ] `spread_move_hit_modifier` (line 1867)
- [ ] `try_primary_hit_event` (line 1884)
- [ ] `run_move_effects_list` (line 1902)
- [ ] `run_move_stub` (line 2011)
- [ ] `use_move_stub` (line 2034)
- [ ] `use_move_inner_stub` (line 2049)
- [ ] `try_spread_move_hit_stub` (line 2063)
- [ ] `hit_step_move_hit_loop_stub` (line 2077)
- [ ] `spread_move_hit_stub` (line 2103)
- [ ] `move_hit_stub` (line 2128)
- [ ] `get_spread_damage_stub` (line 2161)
- [ ] `force_switch_stub` (line 2178)
- [ ] `run_z_power` (line 2235)
- [ ] `run_mega_evo_stub` (line 2277)
- [ ] `terastallize_stub` (line 2298)
- [ ] `try_move_hit_stub` (line 2326)
- [ ] `secondaries_stub` (line 2357)
- [ ] `switch_in_stub` (line 2386)
- [ ] `drag_in_stub` (line 2406)
- [ ] `run_switch_stub` (line 2421)
- [ ] `use_move` (line 2509)
- [ ] `use_move_inner` (line 2707)

### Private Methods

- [ ] `get_accuracy_modifier` (line 939)
- [ ] `z_move_power_table` (line 1164)
- [ ] `max_move_power_table` (line 1241)
- [ ] `default` (line 1985)
- [ ] `test_boost_modifier` (line 3028)
- [ ] `test_stat_with_boost` (line 3038)
- [ ] `test_recoil_damage` (line 3048)
- [ ] `test_confusion_damage` (line 3060)
- [ ] `test_target_type_choices` (line 3067)
- [ ] `test_max_move_name` (line 3076)
- [ ] `test_z_move_name` (line 3084)
- [ ] `test_can_ultra_burst` (line 3091)
- [ ] `test_can_terastallize` (line 3107)

---

## battle_queue.rs

**Total methods:** 45 (43 public, 2 private)

### Public Methods

- [ ] `order` (line 158)
- [ ] `priority` (line 188)
- [ ] `speed` (line 199)
- [ ] `fractional_priority` (line 210)
- [ ] `pokemon_index` (line 218)
- [ ] `side_index` (line 229)
- [ ] `is_move` (line 240)
- [ ] `is_switch` (line 245)
- [ ] `is_run_switch` (line 250)
- [ ] `get_switch_target` (line 255)
- [ ] `new` (line 272)
- [ ] `shift` (line 284)
- [ ] `peek` (line 297)
- [ ] `peek_end` (line 302)
- [ ] `push` (line 311)
- [ ] `unshift` (line 320)
- [ ] `len` (line 325)
- [ ] `is_empty` (line 330)
- [ ] `clear` (line 340)
- [ ] `cancel_action` (line 357)
- [ ] `cancel_move` (line 377)
- [ ] `will_move` (line 403)
- [ ] `will_move_pokemon` (line 416)
- [ ] `will_switch` (line 431)
- [ ] `will_act` (line 453)
- [ ] `insert_run_switch` (line 461)
- [ ] `insert_choice` (line 517)
- [ ] `sort` (line 530)
- [ ] `prioritize_action` (line 573)
- [ ] `iter` (line 588)
- [ ] `iter_mut` (line 593)
- [ ] `will_act_full` (line 602)
- [ ] `change_action` (line 628)
- [ ] `insert_in_order` (line 635)
- [ ] `add_choice` (line 690)
- [ ] `debug` (line 705)
- [ ] `entries` (line 737)
- [ ] `entries_mut` (line 742)
- [ ] `find` (line 747)
- [ ] `remove_where` (line 755)
- [ ] `prioritize_action_ref` (line 772)
- [ ] `resolve_action` (line 912)
- [ ] `get_order_for_choice` (line 1008)
