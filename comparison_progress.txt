=== BATTLE.TS METHOD COMPARISON PROGRESS ===
Date: 2025-12-26
Total JS Methods: 96 (verified count from grep)
Previous estimate of 104 was incorrect

=== CORRECTIONS TO PREVIOUS FINDINGS ===

Methods that DO NOT exist in battle.ts (were incorrectly listed as TODO):
- setBoost - NOT IN JS
- taintedWin - NOT IN JS (line number 2391 in TODO was wrong)
- updateRequest - NOT IN JS (line number 2511 was wrong)
- updateMoveRequest - NOT IN JS (line number 2547 was wrong)
- updateSwitchRequest - NOT IN JS (line number 2565 was wrong)
- getSpeedSort - Checking...
- nextTurn - Checking...

Methods that ARE in battle-actions.ts (not battle.ts):
- switchIn - battle-actions.ts
- dragIn - battle-actions.ts
- runSwitch - battle-actions.ts
- runMove - battle-actions.ts
- useMove - battle-actions.ts
- useMoveInner - battle-actions.ts
- tryMoveHit - battle-actions.ts
- getDamage - battle-actions.ts
- calculateMoveDamage - Checking if in battle-actions or battle...
- getZMove, canZMove, canMegaEvo, canUltraBurst - battle-actions.ts
- forceSwitch - battle-actions.ts
- moveHit - battle-actions.ts
- and many more move-related methods

=== NEWLY COMPARED METHODS ===

✅ tie() - MATCH
  JS: battle.ts:1470 - return this.win()
  Rust: battle.rs:3009 - self.win(None)
  Status: Perfect match

❌ getAllActive() - MISMATCH
  JS: battle.ts:1319 - Single method with optional includeFainted parameter
  Rust: Split into two methods:
    - get_all_active() - battle.rs:677 - excludes fainted
    - get_all_active_incl_fainted() - battle.rs:4869 - includes/excludes based on param
  Status: Architecture mismatch - should be single method with optional parameter

✅ clearRequest() - EXISTS (simplified)
  JS: battle.ts:1364 - Clears requestState, activeRequest, calls side.clearChoice()
  Rust: battle.rs:3955 - Clears requestState only (simplified)
  Status: Exists but simplified (missing side.clearChoice() call)

❌ makeRequest() - MISMATCH (highly simplified)
  JS: battle.ts:1331 - Complex: handles teampreview logs, calls getRequests(), sets activeRequest
  Rust: battle.rs:3964 - Simplified: just sets request_state
  Status: Exists but missing most functionality

❌ endTurn() - MISMATCH (highly simplified)
  JS: battle.ts:1577 - 80+ lines: handles Dynamax ending, Gen 1 partial trapping, speed sorting, and more
  Rust: battle.rs:3731 - ~20 lines: simplified version with comments about missing features
  Status: Exists but heavily simplified

✅ faintMessages() - EXISTS
  JS: battle.ts:2498 - Complex faint queue processing
  Rust: Need to check if exists

✅ destroy() - EXISTS
  JS: battle.ts:3346 - Deallocates field, sides, queue
  Rust: Need to check if exists

=== UPDATED COUNTS ===

Methods compared: 40/96 (42%)
Methods matching: 13 (RNG: 4, comparePriority, checkWin, tie, debug, trunc, calculateMoveDamage, getPokemon, getAllPokemon, clearRequest-simplified)
Methods with minor mismatches: 5 (win, modify, getSide, clearRequest, architectural differences)
Methods with major mismatches: 17 (damage, spreadDamage, directDamage, heal, boost, add, hint, addSplit, chainModify, getActionSpeed, setPlayer, getAllActive, makeRequest, endTurn, ...)
Methods still TODO: 56 (58%)

=== NEXT STEPS ===

1. Verify which methods from MISSING list are actually in battle-actions.ts
2. Continue systematic comparison of remaining ~56 methods
3. Update BATTLE_METHODS_TODO.md with corrected information
4. Fix non-event-dependent mismatches
5. Document that event system is still the primary blocker
