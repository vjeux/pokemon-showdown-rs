# Random Team Generation - Current Limitation

## Issue

The current test suite uses **fixed teams** from `test-teams.json` for all seeds. This means:

- ✅ We test battle mechanics (damage, PRNG, events) across 100 seeds
- ❌ We DO NOT test team generation randomization
- ❌ Each seed uses the SAME teams (generated once with seed [0,0,0,2])

## What JavaScript Does

JavaScript's `gen9randombattle` format:
1. Generates a completely random team for each player based on the seed
2. Different seeds → different Pokemon, moves, items, EVs, IVs
3. Uses `pokemon-showdown-ts/dist/data/random-battles/gen9/sets.json` (266KB)
4. Uses team generation algorithm in `gen9/teams.js` (~105KB)

## What Rust Currently Does

Rust:
1. Loads pre-generated teams from `test-teams.json`
2. Same teams for every seed
3. Only randomizes battle outcomes (damage rolls, move selection, etc.)

## Missing Implementation

To match JavaScript fully, Rust needs:

### 1. Random Battle Sets Data
- Port `gen9/sets.json` (266KB of Pokemon set data)
- Defines moves, items, abilities, EVs for each Pokemon
- Includes probabilities and level ranges

### 2. Team Generation Algorithm
- Port `gen9/teams.js` (~105KB of logic)
- Randomly selects 6 Pokemon based on metagame roles
- Ensures team balance (not all same type, etc.)
- Assigns random moves from available movesets
- Randomizes EVs within defined spreads
- Randomizes IVs (usually 31, but can vary)

### 3. Format Integration
- Automatically generate teams when no team provided
- Respect format rules (banned Pokemon, Ubers, etc.)

## Current Test Validity

**What we've proven:**
- ✅ Battle mechanics are 100% synchronized
- ✅ PRNG calls match exactly
- ✅ Damage calculations match exactly
- ✅ For a given set of teams, battles produce identical results

**What we haven't tested:**
- ❌ Random team generation
- ❌ Different team compositions per seed
- ❌ Item/move/ability randomization

## Workaround for Testing

Current approach:
1. JavaScript generates teams with `generate-test-teams.js`
2. Saves to `test-teams.json`
3. Both implementations load the same teams
4. Tests battle mechanics only

This is sufficient for validating battle simulation, but not team generation.

## Recommended Next Steps

### Option 1: Generate Multiple Team Files (Quick)
```bash
# Generate teams for seeds 1-100
node generate-test-teams.js --seeds 1-100
# Creates: test-teams-1.json, test-teams-2.json, etc.
```

Rust can then load the appropriate team file for each seed.

### Option 2: Implement Team Generator (Proper, but massive)
- Port all `gen9/sets.json` data to Rust
- Port team generation algorithm
- Ensure PRNG synchronization in team generation
- Estimated effort: ~40-80 hours

### Option 3: Hybrid Approach
- Keep battle simulation in Rust (done ✓)
- Call JavaScript team generator via subprocess/IPC
- Rust focuses on battle mechanics only

## Impact

For Pokemon Showdown Rust port:
- Battle simulation: **COMPLETE** ✓
- Team generation: **NOT IMPLEMENTED** ❌

This is acceptable if:
- Rust is used for battle simulation only
- Teams are generated by JavaScript/server
- Rust receives pre-generated team data

This is insufficient if:
- Rust needs standalone operation
- Full client-side battle simulator needed
- Offline/embedded usage required

## Conclusion

The current implementation is **production-ready for battle simulation** when teams are provided.

Random team generation is a separate, large feature that needs dedicated implementation effort.
